<!--pages/order/order.wxml-->
<view class="container">
  <!-- 标签栏 -->
  <view class="tabs">
    <view 
      wx:for="{{tabs}}" 
      wx:key="*this"
      class="tab-item {{currentTab === index ? 'active' : ''}}"
      data-index="{{index}}"
      bindtap="onTabChange"
    >
      {{item}}
    </view>
  </view>

  <!-- 订单列表 -->
  <view class="order-list">
    <block wx:if="{{loading}}">
      <view class="loading">加载中...</view>
    </block>
    <block wx:elif="{{orders.length === 0}}">
      <view class="empty-tip">暂无订单</view>
    </block>
    <block wx:else>
      <view 
        class="order-item"
        wx:for="{{orders}}"
        wx:key="id"
        bindtap="viewOrderDetail"
        data-id="{{item.id}}"
      >
        <view class="order-header">
          <text class="order-type">{{item.type}}</text>
          <text class="order-status {{item.status === '待使用' ? 'pending' : item.status === '已完成' ? 'completed' : 'cancelled'}}">
            {{item.status}}
          </text>
        </view>
        
        <view class="order-content">
          <view class="order-info">
            <view class="info-item">
              <text class="label">预约日期：</text>
              <text class="value">{{item.date}}</text>
            </view>
            <view class="info-item">
              <text class="label">预约时间：</text>
              <text class="value">{{item.time}}</text>
            </view>
            <view class="info-item">
              <text class="label">游客人数：</text>
              <text class="value">{{item.visitorCount || 0}}人</text>
            </view>
            <view class="info-item">
              <text class="label">支付金额：</text>
              <text class="value price">¥{{item.totalPrice || 0}}</text>
            </view>
            <view class="info-item children-info">
              <text class="label">预约儿童：</text>
              <view class="children-list">
                <view class="child-item" wx:for="{{item.children}}" wx:key="id" wx:for-item="child">
                  <text class="child-name">{{child.name}}</text>
                  <text class="child-detail">{{child.age}}岁 {{child.gender}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>

        <view class="order-footer">
          <text class="order-time">下单时间：{{item.createTime}}</text>
          <view class="order-actions">
            <button 
              wx:if="{{item.status === '待使用'}}"
              class="action-btn cancel"
              catchtap="cancelOrder"
              data-id="{{item.id}}"
            >取消订单</button>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- 底部白色条带 -->
  <view class="bottom-white-bar"></view>
</view>